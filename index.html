<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Compute and visualize genetic distances • GDVIS</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Compute and visualize genetic distances">
<meta name="description" content="GDVIS computes and visualizes genetic distances between subtypes of a disorder, a subtype with an external trait, two subypes, or three external traits.">
<meta property="og:description" content="GDVIS computes and visualizes genetic distances between subtypes of a disorder, a subtype with an external trait, two subypes, or three external traits.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">GDVIS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="gdvis-tutorial">GDVIS tutorial<a class="anchor" aria-label="anchor" href="#gdvis-tutorial"></a>
</h1></div>
<p>Anaïs Thijssen (<a href="mailto:a.b.thijssen@gmail.com" class="email">a.b.thijssen@gmail.com</a>) 2025-12-03</p>
<!-- badges: start -->

<hr>
</div>
<div class="section level1">
<h1 id="welcome-to-this-gdvis-tutorial">Welcome to this GDVIS tutorial<a class="anchor" aria-label="anchor" href="#welcome-to-this-gdvis-tutorial"></a>
</h1>
<p><strong>GDVIS (Genetic Distance Visualization)</strong> is an R package that allows you to compute and visualize genetic distances between subtypes of a disorder (2D mode), between a subtype and an external trait (3D mode), between two different subtype definitions (2D_2D mode) and between three different traits (CD mode). Note that all heritabilities need to be on the 50:50 case-control scale. This can be achieved by using the Neffective in LDSC (for more details, see the paper).</p>
<p>Check out the preprint here: <a href="https://doi.org/10.1101/2025.11.18.25340484" class="external-link uri">https://doi.org/10.1101/2025.11.18.25340484</a><br> Check out the GDVIS website here: <a href="https://gdvis.shinyapps.io/gdvis/" class="external-link uri">https://gdvis.shinyapps.io/gdvis/</a></p>
<hr>
</div>
<div class="section level1">
<h1 id="download-and-install-gdvis">Download and install GDVIS<a class="anchor" aria-label="anchor" href="#download-and-install-gdvis"></a>
</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"https://github.com/ABThijsen/GDVIS"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://abthijssen.github.io/GDVIS/">GDVIS</a></span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level1">
<h1 id="gdvis-for-one-subtype">GDVIS for one subtype<a class="anchor" aria-label="anchor" href="#gdvis-for-one-subtype"></a>
</h1>
<p>This GDVIS mode is for computing and visualizing a single subtype of a disorder. We will use the example of major depressive disorder (MDD) with childhood trauma (CT) from the paper. There will be a group of controls and a group of MDD cases. The MDD cases are are divided into individuals with childhood trauma (subtype1-cases) and invididuals without childhood trauma (subtype2-cases). Note that it is important that the subtypes together form the full set of cases (e.g., when comparing a subtype that consists of three different groups, such as low impairment, medium impairment and high impairment, the union of any of two of the groups will not be the same as the set of MDD cases).</p>
<p>GDVIS needs the following minimal input, which needs to be in list format:</p>
<ul>
<li>
<em>h2_sub1.con</em>: the heritability of the GWAS of the subtype1-cases (here MDD with childhood trauma) versus controls.<br>
</li>
<li>
<em>h2_se_sub1.con</em>: the standard error of the heritability<br>
</li>
<li>
<em>name_sub1</em>: the name of subtype1-cases<br>
</li>
<li>
<em>N_sub1</em>: the number of individuals in the subtype1-cases group<br>
</li>
<li>
<em>h2_sub2.con</em>: the heritability of the GWAS of the subtype2-cases (here MDD without childhood trauma) versus controls.<br>
</li>
<li>
<em>h2_se_sub2.con</em>: the standard error of the heritability<br>
</li>
<li>
<em>name_sub2</em>: the name of subtype2-cases<br>
</li>
<li>
<em>N_sub1</em>: the number of individuals in the subtype2-cases group<br>
</li>
<li>
<em>name_allcases</em>: the name of the pool of the subtype1-cases and subtype2-cases group<br>
</li>
<li>
<em>name_con</em>: the name of the controls<br>
</li>
<li>
<em>rg_sub1.con_sub2.con</em>: the genetic correlation between the GWAS subtype1-cases versus controls and the GWAS subtype2-cases versus controls<br>
</li>
<li>
<em>rg_se_sub1.con_sub2.con</em>: the standard error of the genetic correlation</li>
<li>
<em>filename</em>: the name of the file for saving<br>
</li>
<li>
<em>pop.prev_case</em>: the population prevalence of the cases (here the population prevalence of MDD)</li>
</ul>
<p>There are optional variables that you can also add, this will allow GDVIS to check its calculated values against LDSC values, the result of which can be found in the logfile. However, this is not necessary and you can create the input list without these variables.</p>
<ul>
<li>
<em>optional_LDSC_rg_allcases.con_sub1.con</em>: the genetic correlation between the GWAS all cases (the pool of subtype1-cases and subtype2-cases) versus controls and the GWAS subtype1-cases versus controls<br>
</li>
<li>
<em>optional_LDSC_rg_se_allcases.con_sub1.con</em>: the standard error of the genetic correlation<br>
</li>
<li>
<em>optional_LDSC_rg_allcases.con_sub2.con</em>: the genetic correlation between the GWAS all cases (the pool of subtype1-cases and subtype2-cases) versus controls and the GWAS subtype2-cases versus controls<br>
</li>
<li>
<em>optional_LDSC_rg_se_allcases.con_sub2.con</em>: the standard error of the genetic correlation<br>
</li>
<li>
<em>optional_LDSC_h2_sub1.sub2</em>: the heritability of the GWAS of subtype1-cases versus subtype2-cases<br>
</li>
<li>
<em>optional_LDSC_h2_se_sub1.sub2</em>: the standard error of the heritability<br>
</li>
<li>
<em>optional_LDSC_rg_sub1.con_sub1.sub2</em>: the genetic correlation of the GWAS subtype1-cases versus controls and the GWAS subtype1-cases versus subtype2-cases<br>
</li>
<li>
<em>optional_LDSC_rg_se_sub1.con_sub1.sub2</em>: the standard error of the genetic correlation<br>
</li>
<li>
<em>optional_LDSC_rg_sub2.con_sub1.sub2</em>: the genetic correlation of the GWAS subtype2-cases versus controls and the GWAS subtype1-cases versus subtype2-cases<br>
</li>
<li>
<em>optional_LDSC_rg_se_sub2.con_sub1.sub2</em>: the standard error of the genetic correlation<br>
</li>
<li>
<em>optional_LDSC_h2_allcases.con</em>: the heritability of the GWAS of a;; cases (the pool of subtype1-cases and subtype2-cases) versus controls<br>
</li>
<li>
<em>optional_LDSC_h2_se_allcases.con</em>: the standard error of the heritability</li>
<li>
<em>folder_location</em>: if you want to save the output in a different folder than the current working directory</li>
</ul>
<p>GDVIS will not run when there is no suggested evidence of significant difference between subgroups.<br>
Specifically, when rg is not significantly different from 1 (filter 1a) AND h2.sub1 is not clearly different from h2.sub2 (filter 1b and 1c), the triangle will not be plotted.<br>
In some occasions, a triangle will not be plotted while it would have been plotted with larger GWAS sample sizes (and therefore smaller standard errors). GDVIS will also not run when one of the heritabilities is not significant.</p>
<p><strong>Create the input list</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  h2_sub1.con                                   <span class="op">=</span> <span class="fl">0.1606</span>,</span>
<span>  h2_se_sub1.con                                <span class="op">=</span> <span class="fl">0.0139</span>,</span>
<span>  name_sub1                                     <span class="op">=</span> <span class="st">"With CT"</span>,</span>
<span>  N_sub1                                        <span class="op">=</span> <span class="fl">14146</span>,</span>
<span>  h2_sub2.con                                   <span class="op">=</span> <span class="fl">0.0839</span>,</span>
<span>  h2_se_sub2.con                                <span class="op">=</span> <span class="fl">0.0098</span>,</span>
<span>  name_sub2                                     <span class="op">=</span> <span class="st">"Without CT"</span>,</span>
<span>  N_sub2                                        <span class="op">=</span> <span class="fl">16285</span>,</span>
<span>  name_allcases                                 <span class="op">=</span> <span class="st">"all MDD cases"</span>,</span>
<span>  name_con                                      <span class="op">=</span> <span class="st">"controls"</span>,</span>
<span>  rg_sub1.con_sub2.con                          <span class="op">=</span> <span class="fl">0.6011</span>,</span>
<span>  rg_se_sub1.con_sub2.con                       <span class="op">=</span> <span class="fl">0.0610</span>,</span>
<span>  plot_title                                    <span class="op">=</span> <span class="st">"Childhood Trauma"</span>,</span>
<span>  filename                                      <span class="op">=</span> <span class="st">"Childhood Trauma"</span>,</span>
<span>  pop.prev_case                                 <span class="op">=</span> <span class="fl">0.16</span>,</span>
<span>  </span>
<span>  <span class="co"># All variables below can optionally be added to the input.list</span></span>
<span>  optional_LDSC_rg_allcases.con_sub1.con        <span class="op">=</span> <span class="fl">0.9111</span>,   </span>
<span>  optional_LDSC_rg_se_allcases.con_sub1.con     <span class="op">=</span> <span class="fl">0.0167</span>, </span>
<span>  optional_LDSC_rg_allcases.con_sub2.con        <span class="op">=</span> <span class="fl">0.8765</span>,    </span>
<span>  optional_LDSC_rg_se_allcases.con_sub2.con     <span class="op">=</span> <span class="fl">0.0198</span>,     </span>
<span>  optional_LDSC_h2_sub1.sub2                    <span class="op">=</span> <span class="fl">0.1036</span>,  </span>
<span>  optional_LDSC_h2_se_sub1.sub2                 <span class="op">=</span> <span class="fl">0.0162</span>,   </span>
<span>  optional_LDSC_rg_sub1.con_sub1.sub2           <span class="op">=</span> <span class="fl">0.6995</span>,   </span>
<span>  optional_LDSC_rg_se_sub1.con_sub1.sub2        <span class="op">=</span> <span class="fl">0.0389</span>,     </span>
<span>  optional_LDSC_rg_sub2.con_sub1.sub2           <span class="op">=</span> <span class="op">-</span><span class="fl">0.1544</span>, </span>
<span>  optional_LDSC_rg_se_sub2.con_sub1.sub2        <span class="op">=</span> <span class="fl">0.0983</span>,   </span>
<span>  optional_LDSC_h2_allcases.con                 <span class="op">=</span> <span class="fl">0.0915</span>,    </span>
<span>  optional_LDSC_h2_se_allcases.con              <span class="op">=</span> <span class="fl">0.0079</span><span class="op">)</span></span></code></pre></div>
<p><strong>Pass input list to GDVIS_calc</strong><br>
A logfile will also automatically be generated and saved, which you can find in the folder GDVIS_tutorial_output on the github.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GDVIS_calc.html">GDVIS_calc</a></span><span class="op">(</span><span class="va">input.list</span><span class="op">)</span></span></code></pre></div>
<p>GDVIS_calc returns the path to an RData object, which we have put in the variable output (note that the RData object is also saved).<br>
GDVIS_plot_2D takes as input the output generated from GDVIS_calc.<br>
Note that the h2 and rg values in the legend are the GDVIS estimated values and not the optional LDSC values. Note that you can manually set the axes limits (this is especially nice if you have multiple triangles and want to make sure the axes are similar, it can also help with making the legend appear outside of the triangle).</p>
<p><strong>Plot the subtype</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GDVIS_plot(output) This will run as well, but we will add some axes restaints </span></span>
<span><span class="fu"><a href="reference/GDVIS_plot.html">GDVIS_plot</a></span><span class="op">(</span><span class="va">output</span>, x_lower <span class="op">=</span> <span class="op">-</span><span class="fl">0.35</span>, x_upper <span class="op">=</span> <span class="fl">0.35</span>, y_lower <span class="op">=</span> <span class="op">-</span><span class="fl">0.15</span>, y_upper <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span></span></code></pre></div>
<p><img src="screenshot_2D.png" width="70%" style="display: block; margin: auto;"></p>
<hr>
</div>
<div class="section level1">
<h1 id="gdvis-for-one-subtype-with-an-external-trait">GDVIS for one subtype with an external trait<a class="anchor" aria-label="anchor" href="#gdvis-for-one-subtype-with-an-external-trait"></a>
</h1>
<p>GDVIS can also plot an external trait on the subtype visualization, making a 3D plot.<br>
In this example we will add the external trait Anxiety.<br>
GDVIS will not run when the input would result in an invalid geometrical representation (see paper for more details).</p>
<p>GDVIS needs the following extra input:</p>
<ul>
<li>
<em>plot_3D</em>: this tells GDVIS that you want to calculate a subtype with an external trait and should be set to TRUE<br>
</li>
<li>
<em>h2_ext</em>: the heritabitlity of the external trait (on the 50/50 case_control ascertainment scale)<br>
</li>
<li>
<em>h2_se_ext</em>: the standard error of the heritabilty</li>
<li>
<em>rg_sub1.con_ext</em>: the genetic correlation of the GWAS subtype1-cases versus controls and the GWAS of the external trait<br>
</li>
<li>
<em>rg_se_sub1.con_ext</em>: the standard error of the genetic correlation</li>
<li>
<em>rg_sub2.con_ext</em>: the genetic correlation of the GWAS subtype2-cases versus controls and the GWAS of the external trait<br>
</li>
<li>
<em>rg_se_sub2.con_ext</em>: the standard error of the genetic correlation</li>
<li>
<em>name_ext</em>: the name of the external trait<br>
</li>
<li>
<em>pop.prev_ext</em>: the population prevalence of the external trait, if the trait is continuous, set the prevalence to 0.5</li>
</ul>
<p>There is some optional input here as well, will allow GDVIS to check its calculated values against LDSC values:</p>
<ul>
<li>
<em>optional_LDSC_rg_sub1.sub2_ext</em>: the genetic correlation of the GWAS subtype1-cases versus subtype2-cases and the GWAS of the external trait</li>
<li>
<em>optional_LDSC_rg_se_sub1.sub2_ext</em>: the standard error of the genetic correlation</li>
<li>
<em>optional_LDSC_rg_allcases.con_ext</em>: the genetic correlation of the GWAS all cases (the union of subtype1-cases and subtype2-cases) and the GWAS of the external trait</li>
<li>
<em>optional_LDSC_rg_se_allcases.con_ext</em>: the standard error of the genetic correlation</li>
</ul>
<p><strong>Create the input list</strong></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input.list.3D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  </span>
<span>  <span class="co"># 2D required input</span></span>
<span>  h2_sub1.con                                   <span class="op">=</span> <span class="fl">0.1606</span>,</span>
<span>  h2_se_sub1.con                                <span class="op">=</span> <span class="fl">0.0139</span>,</span>
<span>  name_sub1                                     <span class="op">=</span> <span class="st">"With CT"</span>,</span>
<span>  N_sub1                                        <span class="op">=</span> <span class="fl">14146</span>,</span>
<span>  h2_sub2.con                                   <span class="op">=</span> <span class="fl">0.0839</span>,</span>
<span>  h2_se_sub2.con                                <span class="op">=</span> <span class="fl">0.0098</span>,</span>
<span>  name_sub2                                     <span class="op">=</span> <span class="st">"Without CT"</span>,</span>
<span>  N_sub2                                        <span class="op">=</span> <span class="fl">16285</span>,</span>
<span>  name_allcases                                 <span class="op">=</span> <span class="st">"all MDD cases"</span>,</span>
<span>  name_con                                      <span class="op">=</span> <span class="st">"controls"</span>,</span>
<span>  rg_sub1.con_sub2.con                          <span class="op">=</span> <span class="fl">0.6011</span>,</span>
<span>  rg_se_sub1.con_sub2.con                       <span class="op">=</span> <span class="fl">0.0610</span>,</span>
<span>  plot_title                                    <span class="op">=</span> <span class="st">"Childhood Trauma"</span>,</span>
<span>  filename                                      <span class="op">=</span> <span class="st">"Childhood Trauma"</span>,</span>
<span>  pop.prev_case                                 <span class="op">=</span> <span class="fl">0.16</span>, </span>
<span>  </span>
<span>  <span class="co"># 2D optional input   </span></span>
<span>  optional_LDSC_rg_allcases.con_sub1.con        <span class="op">=</span> <span class="fl">0.9111</span>,   </span>
<span>  optional_LDSC_rg_se_allcases.con_sub1.con     <span class="op">=</span> <span class="fl">0.0167</span>, </span>
<span>  optional_LDSC_rg_allcases.con_sub2.con        <span class="op">=</span> <span class="fl">0.8765</span>,    </span>
<span>  optional_LDSC_rg_se_allcases.con_sub2.con     <span class="op">=</span> <span class="fl">0.0198</span>,     </span>
<span>  optional_LDSC_h2_sub1.sub2                    <span class="op">=</span> <span class="fl">0.1036</span>,  </span>
<span>  optional_LDSC_h2_se_sub1.sub2                 <span class="op">=</span> <span class="fl">0.0162</span>,   </span>
<span>  optional_LDSC_rg_sub1.con_sub1.sub2           <span class="op">=</span> <span class="fl">0.6995</span>,   </span>
<span>  optional_LDSC_rg_se_sub1.con_sub1.sub2        <span class="op">=</span> <span class="fl">0.0389</span>,     </span>
<span>  optional_LDSC_rg_sub2.con_sub1.sub2           <span class="op">=</span> <span class="op">-</span><span class="fl">0.1544</span>, </span>
<span>  optional_LDSC_rg_se_sub2.con_sub1.sub2        <span class="op">=</span> <span class="fl">0.0983</span>,   </span>
<span>  optional_LDSC_h2_allcases.con                 <span class="op">=</span> <span class="fl">0.0915</span>,    </span>
<span>  optional_LDSC_h2_se_allcases.con              <span class="op">=</span> <span class="fl">0.0079</span>,</span>
<span>  </span>
<span>  <span class="co"># 3D required input</span></span>
<span>  plot_3D                                       <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  h2_ext                                        <span class="op">=</span> <span class="fl">0.0738</span>,</span>
<span>  h2_se_ext                                     <span class="op">=</span> <span class="fl">0.0276</span>,</span>
<span>  rg_sub1.con_ext                               <span class="op">=</span> <span class="fl">0.5883</span>,</span>
<span>  rg_se_sub1.con_ext                            <span class="op">=</span> <span class="fl">0.1629</span>,</span>
<span>  rg_sub2.con_ext                               <span class="op">=</span> <span class="fl">0.6665</span>,</span>
<span>  rg_se_sub2.con_ext                            <span class="op">=</span> <span class="fl">0.1733</span>,</span>
<span>  name_ext                                      <span class="op">=</span> <span class="st">"Anxiety"</span>,</span>
<span>  pop.prev_ext                                  <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  </span>
<span>  <span class="co"># 3D optional input</span></span>
<span>  optional_LDSC_rg_sub1.sub2_ext                <span class="op">=</span> <span class="fl">0.1198</span>,</span>
<span>  optional_LDSC_rg_se_sub1.sub2_ext             <span class="op">=</span> <span class="fl">0.1797</span>,</span>
<span>  optional_LDSC_rg_allcases.con_ext             <span class="op">=</span> <span class="fl">0.6942</span>,</span>
<span>  optional_LDSC_rg_se_allcases.con_ext          <span class="op">=</span> <span class="fl">0.1733</span><span class="op">)</span> </span></code></pre></div>
<p><strong>Pass input list to GDVIS_calc</strong><br>
A logfile will also automatically be generated and saved, which you can find in the folder GDVIS_tutorial_output on the github.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output.3D</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GDVIS_calc.html">GDVIS_calc</a></span><span class="op">(</span><span class="va">input.list.3D</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot the subtype with external trait</strong><br>
Pass the output object to the plot function to see the plot. The plot is created as .html, the legend as .png and the shiny app shows them together<br>
Running the code below will open a window containing a shiny object that you can move in 3D space.<br>
This RMarkdown file cannot handle interactive shiny output, for an example of the resulting visualization of the code below, see: <a href="https://gdvis.shinyapps.io/gdvis/" class="external-link uri">https://gdvis.shinyapps.io/gdvis/</a><br>
The plot below is a screenshot of the 3D interactive visualization.<br>
It is possible to just make and save the plots without rendering them and to make the plots without showing the labels.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#GDVIS_plot(output.3D, show.rendering = FALSE, show.names = FALSE)</span></span>
<span><span class="fu"><a href="reference/GDVIS_plot.html">GDVIS_plot</a></span><span class="op">(</span><span class="va">output.3D</span><span class="op">)</span></span></code></pre></div>
<p><img src="screenshot_3D.png" width="70%" style="display: block; margin: auto;"></p>
<hr>
</div>
<div class="section level1">
<h1 id="gdvis-for-comparing-two-subtypes">GDVIS for comparing two subtypes<a class="anchor" aria-label="anchor" href="#gdvis-for-comparing-two-subtypes"></a>
</h1>
<p>GDVIS can compute and visualize the relationship between two subtype definitions in 3D geometrical space. You will need all the individual data for both subtype definitions and some information on their relation.<br>
GDVIS will not run when the input would result in an invalid geometrical representation (see paper for more details)</p>
<p>Besides the single subtype information, GDVIS needs the following:</p>
<ul>
<li>
<em>plot_2D.2D</em>: this tells GDVIS to run in the subtype vs subtype mode<br>
</li>
<li>
<em>rg_triangle1.sub1.sub2_triangle2.sub1.sub2</em>: the genetic correlation of the GWAS subtype1-cases versus subtype2-cases from subtype definition A and the GWAS subtype1-cases versus subtype2-cases from subtype definition B</li>
<li>
<em>rg_se_triangle1.sub1.sub2_triangle2.sub1.sub2</em>: the standard error the the genetic correlation<br>
</li>
<li>
<em>rg_triangle1.sub1.con_triangle2.sub1.con</em>: the genetic correlation of the GWAS subtype1-cases versus controls from subtype definition A and the GWAS subtype1-cases versus controls from subtype definition B<br>
</li>
<li>
<em>rg_se_triangle1.sub1.con_triangle2.sub1.con</em>: the standard error the the genetic correlation<br>
</li>
<li>
<em>rg_triangle1.sub2.con_triangle2.sub1.con</em>: the genetic correlation of the GWAS subtype12-cases versus controls from subtype definition A and the GWAS subtype1-cases versus controls from subtype definition B<br>
</li>
<li>
<em>rg_se_triangle1.sub2.con_triangle2.sub1.con</em>: the standard error the the genetic correlation<br>
</li>
<li>
<em>rg_triangle1.sub1.con_triangle2.sub2.con</em>: the genetic correlation of the GWAS subtype1-cases versus controls from subtype definition A and the GWAS subtype2-cases versus controls from subtype definition B<br>
</li>
<li>
<em>rg_se_triangle1.sub1.con_triangle2.sub2.con</em>: the standard error the the genetic correlation<br>
</li>
<li>
<em>rg_triangle1.sub2.con_triangle2.sub2.con</em>: the genetic correlation of the GWAS subtype2-cases versus controls from subtype definition A and the GWAS subtype2-cases versus controls from subtype definition B<br>
</li>
<li>
<em>rg_se_triangle1.sub2.con_triangle2.sub2.con</em>: the standard error the the genetic correlation</li>
</ul>
<p><strong>Create the input list</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input.list.2D.2D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span></span>
<span>  <span class="co"># Subgroup info triangle 1</span></span>
<span>  triangle1.h2_sub1.con                                 <span class="op">=</span> <span class="fl">0.1606</span>,</span>
<span>  triangle1.h2_se_sub1.con                              <span class="op">=</span> <span class="fl">0.0139</span>,</span>
<span>  triangle1.name_sub1                                   <span class="op">=</span> <span class="st">"With childhood trauma"</span>,</span>
<span>  triangle1.N_sub1                                      <span class="op">=</span> <span class="fl">14146</span>,</span>
<span>  triangle1.h2_sub2.con                                 <span class="op">=</span> <span class="fl">0.0839</span>,</span>
<span>  triangle1.h2_se_sub2.con                              <span class="op">=</span> <span class="fl">0.0098</span>,</span>
<span>  triangle1.name_sub2                                   <span class="op">=</span> <span class="st">"without childhood trauma"</span>,</span>
<span>  triangle1.N_sub2                                      <span class="op">=</span> <span class="fl">16285</span>, </span>
<span>  triangle1.name_allcases                               <span class="op">=</span> <span class="st">"all MDD cases"</span>,</span>
<span>  triangle1.name_con                                    <span class="op">=</span> <span class="st">"MDD controls"</span>,</span>
<span>  triangle1.rg_sub1.con_sub2.con                        <span class="op">=</span> <span class="fl">0.6011</span>,</span>
<span>  triangle1.rg_se_sub1.con_sub2.con                     <span class="op">=</span> <span class="fl">0.0610</span>,</span>
<span></span>
<span>  <span class="co"># General info triangle 1</span></span>
<span>  triangle1.plot_title                                  <span class="op">=</span> <span class="st">"Childhood Trauma"</span>,</span>
<span>  triangle1.filename                                    <span class="op">=</span> <span class="st">"Childhood Trauma"</span>,</span>
<span>  triangle1.pop.prev_case                               <span class="op">=</span> <span class="fl">0.16</span>,</span>
<span>  </span>
<span>  <span class="co"># Optional input triangle 1</span></span>
<span>  triangle1.optional_LDSC_rg_allcases.con_sub1.con      <span class="op">=</span> <span class="fl">0.9111</span>,</span>
<span>  triangle1.optional_LDSC_rg_se_allcases.con_sub1.con   <span class="op">=</span> <span class="fl">0.0167</span>,</span>
<span>  triangle1.optional_LDSC_rg_allcases.con_sub2.con      <span class="op">=</span> <span class="fl">0.8765</span>,</span>
<span>  triangle1.optional_LDSC_rg_se_allcases.con_sub2.con   <span class="op">=</span> <span class="fl">0.0198</span>,</span>
<span>  triangle1.optional_LDSC_h2_sub1.sub2                  <span class="op">=</span> <span class="fl">0.1036</span>,</span>
<span>  triangle1.optional_LDSC_h2_se_sub1.sub2               <span class="op">=</span> <span class="fl">0.0162</span>,</span>
<span>  triangle1.optional_LDSC_rg_sub1.con_sub1.sub2         <span class="op">=</span> <span class="fl">0.6995</span>,</span>
<span>  triangle1.optional_LDSC_rg_se_sub1.con_sub1.sub2      <span class="op">=</span> <span class="fl">0.0389</span>,</span>
<span>  triangle1.optional_LDSC_rg_sub2.con_sub1.sub2         <span class="op">=</span> <span class="op">-</span><span class="fl">0.1544</span>,</span>
<span>  triangle1.optional_LDSC_rg_se_sub2.con_sub1.sub2      <span class="op">=</span> <span class="fl">0.0983</span>,</span>
<span>  triangle1.optional_LDSC_h2_allcases.con               <span class="op">=</span> <span class="fl">0.0915</span>,  </span>
<span>  triangle1.optional_LDSC_h2_se_allcases.con            <span class="op">=</span> <span class="fl">0.0079</span>,</span>
<span>  </span>
<span>  <span class="co"># Subgroup info triangle 2</span></span>
<span>  triangle2.h2_sub1.con                                 <span class="op">=</span> <span class="fl">0.1394</span>,</span>
<span>  triangle2.h2_se_sub1.con                              <span class="op">=</span> <span class="fl">0.0147</span>,</span>
<span>  triangle2.name_sub1                                   <span class="op">=</span> <span class="st">"With anxiety"</span>,</span>
<span>  triangle2.N_sub1                                      <span class="op">=</span> <span class="fl">11885</span>,</span>
<span>  triangle2.h2_sub2.con                                 <span class="op">=</span> <span class="fl">0.0798</span>,</span>
<span>  triangle2.h2_se_sub2.con                              <span class="op">=</span> <span class="fl">0.0098</span>,</span>
<span>  triangle2.name_sub2                                   <span class="op">=</span> <span class="st">"without anxiety"</span>,</span>
<span>  triangle2.N_sub2                                      <span class="op">=</span> <span class="fl">18546</span>,</span>
<span>  triangle2.name_allcases                               <span class="op">=</span> <span class="st">"all MDD cases"</span>,</span>
<span>  triangle2.name_con                                    <span class="op">=</span> <span class="st">"MDD controls"</span>,</span>
<span>  triangle2.rg_sub1.con_sub2.con                        <span class="op">=</span> <span class="fl">0.8451</span>,</span>
<span>  triangle2.rg_se_sub1.con_sub2.con                     <span class="op">=</span> <span class="fl">0.0720</span>,</span>
<span></span>
<span>  <span class="co"># General info triangle 2</span></span>
<span>  triangle2.plot_title                                  <span class="op">=</span> <span class="st">"Comorbid anxiety"</span>, </span>
<span>  triangle2.filename                                    <span class="op">=</span> <span class="st">"Comorbid anxiety"</span>,</span>
<span>  triangle2.pop.prev_case                               <span class="op">=</span> <span class="fl">0.16</span>,</span>
<span></span>
<span>  <span class="co"># Optional input triangle 2</span></span>
<span>  triangle2.optional_LDSC_rg_allcases.con_sub1.con      <span class="op">=</span> <span class="fl">0.9504</span>,</span>
<span>  triangle2.optional_LDSC_rg_se_allcases.con_sub1.con   <span class="op">=</span> <span class="fl">0.0235</span>,</span>
<span>  triangle2.optional_LDSC_rg_allcases.con_sub2.con      <span class="op">=</span> <span class="fl">0.9686</span>,</span>
<span>  triangle2.optional_LDSC_rg_se_allcases.con_sub2.con   <span class="op">=</span> <span class="fl">0.0153</span>,</span>
<span>  triangle2.optional_LDSC_h2_sub1.sub2                  <span class="op">=</span> <span class="fl">0.0450</span>,</span>
<span>  triangle2.optional_LDSC_h2_se_sub1.sub2               <span class="op">=</span> <span class="fl">0.0166</span>,</span>
<span>  triangle2.optional_LDSC_rg_sub1.con_sub1.sub2         <span class="op">=</span> <span class="fl">0.6503</span>,</span>
<span>  triangle2.optional_LDSC_rg_se_sub1.con_sub1.sub2      <span class="op">=</span> <span class="fl">0.0752</span>,</span>
<span>  triangle2.optional_LDSC_rg_sub2.con_sub1.sub2         <span class="op">=</span> <span class="fl">0.1302</span>,</span>
<span>  triangle2.optional_LDSC_rg_se_sub2.con_sub1.sub2      <span class="op">=</span> <span class="fl">0.1870</span>,</span>
<span>  triangle2.optional_LDSC_h2_allcases.con               <span class="op">=</span> <span class="fl">0.0915</span>,  </span>
<span>  triangle2.optional_LDSC_h2_se_allcases.con            <span class="op">=</span> <span class="fl">0.0079</span>,</span>
<span></span>
<span>  <span class="co"># Required data on triangle relations </span></span>
<span>  rg_triangle1.sub1.sub2_triangle2.sub1.sub2            <span class="op">=</span> <span class="fl">0.4084</span>,</span>
<span>  rg_se_triangle1.sub1.sub2_triangle2.sub1.sub2         <span class="op">=</span> <span class="fl">0.1793</span>, </span>
<span>  rg_triangle1.sub1.con_triangle2.sub1.con              <span class="op">=</span> <span class="fl">0.9139</span>,</span>
<span>  rg_se_triangle1.sub1.con_triangle2.sub1.con           <span class="op">=</span> <span class="fl">0.0326</span>,</span>
<span>  rg_triangle1.sub2.con_triangle2.sub1.con              <span class="op">=</span> <span class="fl">0.7831</span>,</span>
<span>  rg_se_triangle1.sub2.con_triangle2.sub1.con           <span class="op">=</span> <span class="fl">0.0431</span>,</span>
<span>  rg_triangle1.sub1.con_triangle2.sub2.con              <span class="op">=</span> <span class="fl">0.8452</span>,</span>
<span>  rg_se_triangle1.sub1.con_triangle2.sub2.con           <span class="op">=</span> <span class="fl">0.0316</span>,</span>
<span>  rg_triangle1.sub2.con_triangle2.sub2.con              <span class="op">=</span> <span class="fl">0.8882</span>,</span>
<span>  rg_se_triangle1.sub2.con_triangle2.sub2.con           <span class="op">=</span> <span class="fl">0.0328</span>,</span>
<span></span>
<span>  <span class="co"># Type info</span></span>
<span>  plot_2D.2D                                            <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Pass input list to GDVIS_calc</strong><br>
A logfile will also automatically be generated and saved, which you can find in the folder GDVIS_tutorial_output on the github.<br>
This function will first create the separate subtype plots (and save them) and then create the 3D visualization.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output.2D.2D</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GDVIS_calc.html">GDVIS_calc</a></span><span class="op">(</span><span class="va">input.list.2D.2D</span><span class="op">)</span></span></code></pre></div>
<p><strong>Plot the subtypes</strong><br>
Pass the output object to the plot function to see the plot. The plot is created as .html, the legend as .png and the shiny app shows them together<br>
Running the code below will open a window containing a shiny object that you can more in 3D space.<br>
This RMarkdown file cannot handle interactive shiny output, for an example of the resulting visualization of the code below, see: <a href="https://gdvis.shinyapps.io/gdvis/" class="external-link uri">https://gdvis.shinyapps.io/gdvis/</a><br>
The plot below is a screenshot of the 3D interactive visualization.<br>
It is possible to just make and save the plots without rendering them and to make the plots without showing the labels.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#GDVIS_plot(output.2D.2D, show.rendering = FALSE, show.names = FALSE)</span></span>
<span><span class="fu"><a href="reference/GDVIS_plot.html">GDVIS_plot</a></span><span class="op">(</span><span class="va">output.2D.2D</span><span class="op">)</span></span></code></pre></div>
<p><img src="screenshot_2D_2D.png" width="70%" style="display: block; margin: auto;"></p>
<hr>
</div>
<div class="section level1">
<h1 id="gdvis-for-multiple-traits">GDVIS for multiple traits<a class="anchor" aria-label="anchor" href="#gdvis-for-multiple-traits"></a>
</h1>
<p><strong>Create the input list</strong><br>
Note that no standard errors are asked, you need to check yourself whether your data is sensible to plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">input.list.CD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  plot_CD                                       <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  name_trait1                                   <span class="op">=</span> <span class="st">"SCZ_cases"</span>,</span>
<span>  name_trait2                                   <span class="op">=</span> <span class="st">"BIP_cases"</span>,</span>
<span>  name_trait3                                   <span class="op">=</span> <span class="st">"MDD_cases"</span>,</span>
<span>  name_trait1.con                               <span class="op">=</span> <span class="st">"SCZ_con"</span>,</span>
<span>  name_trait2.con                               <span class="op">=</span> <span class="st">"BIP_con"</span>,</span>
<span>  name_trait3.con                               <span class="op">=</span> <span class="st">"MDD_con"</span>,</span>
<span>  rg_trait1_trait2                              <span class="op">=</span> <span class="fl">0.6986</span>,</span>
<span>  rg_trait1_trait3                              <span class="op">=</span> <span class="fl">0.3598</span>,</span>
<span>  rg_trait2_trait3                              <span class="op">=</span> <span class="fl">0.4758</span>,</span>
<span>  h2_trait1                                     <span class="op">=</span> <span class="fl">0.4118</span>,</span>
<span>  h2_trait2                                     <span class="op">=</span> <span class="fl">0.2902</span>,</span>
<span>  h2_trait3                                     <span class="op">=</span> <span class="fl">0.0703</span>,</span>
<span>  pop.prev_trait1                               <span class="op">=</span> <span class="fl">0.004</span>,</span>
<span>  pop.prev_trait2                               <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  pop.prev_trait3                               <span class="op">=</span> <span class="fl">0.16</span><span class="op">)</span></span></code></pre></div>
<p><strong>Pass input list to GDVIS_calc</strong><br>
A logfile will also automatically be generated and saved, which you can find in the folder GDVIS_tutorial_output on the github.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output.CD</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GDVIS_calc.html">GDVIS_calc</a></span><span class="op">(</span><span class="va">input.list.CD</span><span class="op">)</span></span></code></pre></div>
<p>Pass the output object to the plot function to see the plot. The plot is created as .html, the legend as .png and the shiny app shows them together<br>
Running the code below will open a window containing a shiny object that you can more in 3D space.<br>
This RMarkdown file cannot handle interactive shiny output, for an example of the resulting visualization of the code below, see: <a href="https://gdvis.shinyapps.io/gdvis/" class="external-link uri">https://gdvis.shinyapps.io/gdvis/</a><br>
The plot below is a screenshot of the 3D interactive visualization.<br>
It is possible to just make and save the plots without rendering them and to make the plots without showing the labels.</p>
<p><strong>Plot the subtype</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#GDVIS_plot(output.CD, show.rendering = FALSE, show.names = FALSE)</span></span>
<span><span class="fu"><a href="reference/GDVIS_plot.html">GDVIS_plot</a></span><span class="op">(</span><span class="va">output.CD</span><span class="op">)</span></span></code></pre></div>
<p><img src="screenshot_CD.png" width="70%" style="display: block; margin: auto;"></p>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://creativecommons.org/licenses/by/4.0" class="external-link">CC BY 4.0</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing GDVIS</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Anaïs Thijssen <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=GDVIS" class="external-link"><img src="https://www.r-pkg.org/badges/version/GDVIS" alt="CRAN status"></a></li>
<li><a href="https://github.com/ABthijssen/GDVIS/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/stefanvermeent/projectlog/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anaïs Thijssen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
